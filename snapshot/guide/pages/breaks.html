<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script src="/cdn-cgi/apps/head/3cOPSgo5Omz84ycX7CvigfX4cpw.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-82213539-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-82213539-2');
    </script>
    <title>19.4 Breaking Changes 2.1.0.BUILD-SNAPSHOT</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="https://docs.micronaut.io/docsassets/css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="https://docs.micronaut.io/docsassets/css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <div class="navTitle">
        
        Micronaut
    </div>
    <div class="navLinks">
        <ul>
            <li>
                <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                    <a href="../../guide/index.html" class="button">Table of contents</a>

                    <div id="nav-summary-childs" style="display:none;">
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/introduction.html"><strong>1</strong><span>Introduction</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/quickStart.html"><strong>2</strong><span>Quick Start</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/ioc.html"><strong>3</strong><span>Inversion of Control</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/config.html"><strong>4</strong><span>Application Configuration</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/aop.html"><strong>5</strong><span>Aspect Oriented Programming</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/httpServer.html"><strong>6</strong><span>The HTTP Server</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/httpClient.html"><strong>7</strong><span>The HTTP Client</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/cloud.html"><strong>8</strong><span>Cloud Native Features</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/serverlessFunctions.html"><strong>9</strong><span>Serverless Functions</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/messaging.html"><strong>10</strong><span>Message-Driven Microservices</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/commandLineApps.html"><strong>11</strong><span>Standalone Command Line Applications</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/configurations.html"><strong>12</strong><span>Configurations</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/languageSupport.html"><strong>13</strong><span>Language Support</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/management.html"><strong>14</strong><span>Management &amp; Monitoring</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/security.html"><strong>15</strong><span>Security</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/multitenancy.html"><strong>16</strong><span>Multi-Tenancy</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/cli.html"><strong>17</strong><span>Micronaut CLI</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/i18n.html"><strong>18</strong><span>Internationalization</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/appendix.html"><strong>19</strong><span>Appendices</span></a>
                        </div>
                        
                    </div>
                </div>
            </li>
            <li class="separator selected">
                <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
            </li>
        </ul>
    </div>


</div>

<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../../guide/i18n.html">&lt;&lt; <strong>18</strong><span>Internationalization</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                


                <div class="project">
                    <h1>19.4 Breaking Changes</h1>

                    <p><strong>Version:</strong> 2.1.0.BUILD-SNAPSHOT</p>
                </div>

                

                
<h2 id="breaks"><a class="anchor" href="#breaks"></a>19.4 Breaking Changes</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/appendix/breaks.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>This section will document breaking changes between Micronaut 1.0 and Micronaut 2.0</p>
</div>
<div class="sect2">
<h3 id="_thread_pool_selection_now_manual">Thread Pool Selection Now Manual</h3>
<div class="paragraph">
<p>In Micronaut 1.x, Micronaut would attempt to automatically deduce the thread pool to use based on the return type of the controller method.</p>
</div>
<div class="paragraph">
<p>This approach caused some confusion and created a false association between reactive types and blocking operations.</p>
</div>
<div class="paragraph">
<p>Micronaut 2.x now leaves it up to the user to specify the thread pool to schedule operations on, including blocking operations.</p>
</div>
<div class="paragraph">
<p>If you are upgrading from Micronaut 1.x and have a controller that executes blocking I/O operations (such as JDBC or JPA) it is recommended that you add the <a href="../api/io/micronaut/scheduling/annotation/ExecuteOn.html">@ExecuteOn</a> annotation to execute the blocking operations on a different thread.</p>
</div>
<div class="listingblock multi-language-sample">
<div class="title">Using @ExecuteOn</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.micronaut.http.annotation.*;
import io.micronaut.scheduling.TaskExecutors;
import io.micronaut.scheduling.annotation.ExecuteOn;

@Controller("/executeOn/people")
public class PersonController {

    private final PersonService personService;

    PersonController(
            PersonService personService) {
        this.personService = personService;
    }

    @Get("/{name}")
    @ExecuteOn(TaskExecutors.IO) <b class="conum">(1)</b>
    Person byName(String name) {
        return personService.findByName(name);
    }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">Using @ExecuteOn</div>
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">import io.micronaut.http.annotation.*
import io.micronaut.scheduling.TaskExecutors
import io.micronaut.scheduling.annotation.ExecuteOn

@Controller("/executeOn/people")
class PersonController {

    private final PersonService personService

    PersonController(
            PersonService personService) {
        this.personService = personService
    }

    @Get("/{name}")
    @ExecuteOn(TaskExecutors.IO) <b class="conum">(1)</b>
    Person byName(String name) {
        return personService.findByName(name)
    }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title">Using @ExecuteOn</div>
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">import io.micronaut.http.annotation.*
import io.micronaut.scheduling.TaskExecutors
import io.micronaut.scheduling.annotation.ExecuteOn

@Controller("/executeOn/people")
class PersonController (private val personService: PersonService) {
    @Get("/{name}")
    @ExecuteOn(TaskExecutors.IO) <b class="conum">(1)</b>
    fun byName(name: String): Person {
        return personService.findByName(name)
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="../api/io/micronaut/scheduling/annotation/ExecuteOn.html">@ExecuteOn</a> annotation is used to execute the operation on the I/O thread pool</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you wish to return to the previous behaviour as defined in Micronaut 1.x you can set <code>micronaut.server.thread-selection</code> to <code>AUTO</code> in configuration.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_micronaut_cache_removed_from_core">Micronaut Cache Removed from Core</h3>
<div class="paragraph">
<p>The <code>micronaut-runtime</code> module in Micronaut 1.x included support for caching AOP with the <code>@Cache</code> annotation. The core caching library and a default implementation based on caffeine were included.</p>
</div>
<div class="paragraph">
<p>If you are using the caffeine backed cache support, you must add a dependency to continue doing so. Add <code>io.micronaut.cache:micronaut-cache-caffeine</code> to your build to maintain the existing functionality. The new caffeine cache module no longer uses the internal shadowed caffeine version and declares its own normal dependency on caffeine. You may need to exclude the transitive dependency in order to prevent conflicts with other versions that may be being pulled in.</p>
</div>
<div class="paragraph">
<p>The management endpoint for caches is no longer included by default in the <code>micronaut-management</code> module. If you would like to use the caches endpoint, add a dependency on <code>io.micronaut.cache:micronaut-cache-management</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_support_for_rxjava_1_x_removed_from_core">Support for RxJava 1.x Removed from Core</h3>
<div class="paragraph">
<p>RxJava 1.x support is no longer included in core by default. You can re-enable support by adding the following dependency:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"io.micronaut.rxjava1:micronaut-rxjava1")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.rxjava1&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-rxjava1&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</p>
</div>
</div>
<div class="sect2">
<h3 id="_support_for_reactor_removed_from_core">Support for Reactor Removed from Core</h3>
<div class="paragraph">
<p>Reactor support is no longer included in core by default. You can re-enable support by adding the following dependency:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"io.micronaut.reactor:micronaut-reactor")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.reactor&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-reactor&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</p>
</div>
</div>
<div class="sect2">
<h3 id="_loggers_endpoint_modifications_now_sensitive">Loggers Endpoint Modifications Now Sensitive</h3>
<div class="paragraph">
<p>The method on the loggers endpoint to modify logging is now sensitive by default. To revert to the previous behavior, apply the following configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">endpoints:
    loggers:
        write-sensitive: false</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_server_side_content_negotiation_may_require_test_changes">Server Side Content Negotiation May Require Test Changes</h3>
<div class="paragraph">
<p>The new support for server side content negotiation may require changes to tests. For example a test that that makes a call such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String result = client.toBlocking().retrieve(
    HttpRequest.GET('/test')
        .accept("text/plain"), String
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the server implementation does not declare the route as <code>@Produces("text/plain")</code> the request will be rejected with a <code>NOT_ACCEPTABLE</code> HTTP status code.</p>
</div>
</div>
<div class="sect2">
<h3 id="_server_filter_ordering">Server Filter Ordering</h3>
<div class="paragraph">
<p>In Micronaut 1.x almost all built in filters operated on order 0, meaning the order was non deterministic. That caused some compatibility issues with the metrics and security modules. A new class has been added <a href="../api/io/micronaut/http/filter/ServerFilterPhase.html">ServerFilterPhase</a> that defines the phases of server filtering and sets an order. Many filters have been updated to now have their order reflect the phase they participate in.</p>
</div>
</div>
<div class="sect2">
<h3 id="_heartbeat_events_no_longer_published_if_no_discovery_clients_present">Heartbeat Events No Longer Published if no Discovery Clients present</h3>
<div class="paragraph">
<p>A <a href="../api/io/micronaut/health/HeartbeatEvent.html">HeartbeatEvent</a> is no longer published automatically if there are no <a href="../api/io/micronaut/discovery/DiscoveryClient.html">DiscoveryClient</a> instances present.</p>
</div>
<div class="paragraph">
<p>This behaviour can be changed by setting <code>micronaut.heartbeat.enabled</code> to <code>true</code> explicitly in configuration.</p>
</div>
</div>
<div class="sect2">
<h3 id="_several_typeconverters_are_no_longer_beans">Several TypeConverters Are No Longer Beans</h3>
<div class="paragraph">
<p>Many <code>TypeConverter</code> instances that were previously beans are no longer beans and are deprecated including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../api/io/micronaut/http/MediaTypeConverter.html">MediaTypeConverter</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/convext/converters/StringToClassConverter.html">StringToClassConverter</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/convext/converters/StringArrayToClassArrayConverter.html">StringArrayToClassArrayConverter</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/http/client/converters/SocketAddressConverter.html">SocketAddressConverter</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/reactive/reactor/converters/PublisherToMonoConverter.html">PublisherToMonoConverter</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/reactive/reactor/converters/PublisherToFluxConverter.html">PublisherToFluxConverter</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/reactive/reactor/converters/ObjectToFluxConverter.html">ObjectToFluxConverter</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/reactive/reactor/converters/ObjectToMonoConverter.html">ObjectToMonoConverter</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/jackson/convert/JsonNodeToObjectConverter.html">JsonNodeToObjectConverter</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/jackson/convert/MapToObjectConverter.html">MapToObjectConverter</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/jackson/convert/ObjectToJsonNodeConverter.html">ObjectToJsonNodeConverter</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/jackson/convert/ArrayNodeToArrayConverter.html">ArrayNodeToArrayConverter</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/jackson/convert/ArrayNodeToIterableConverter.html">ArrayNodeToIterableConverter</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/jackson/convert/ObjectNodeToConvertibleValuesConverter.html">ObjectNodeToConvertibleValuesConverter</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/runtime/http/converters/HttpStatusConverter.html">HttpStatusConverter</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These should not be injected directly but instead used through the <a href="../api/io/micronaut/core/convert/ConversionService.html">ConversionService</a> API.</p>
</div>
</div>
<div class="sect2">
<h3 id="_executable_no_longer_stereotype_of_around">@Executable No Longer Stereotype of @Around</h3>
<div class="paragraph">
<p>In Micronaut 1.x the <a href="../api/io/micronaut/context/annotation/Executable.html">@Executable</a> annotation was a meta-annotation specified on the <a href="../api/io/micronaut/aop/Around.html">@Around</a> and <a href="../api/io/micronaut/aop/Introduction.html">@Introduction</a> annotations. This meant that an <a href="../api/io/micronaut/inject/ExecutableMethod.html">ExecutableMethod</a> reference was generated for every usage of AOP advice which consumed additional memory unnecessarily.</p>
</div>
<div class="paragraph">
<p>In Micronaut 2.x and above this is no longer the case and if you need an <a href="../api/io/micronaut/inject/ExecutableMethod.html">ExecutableMethod</a> generated you should add the <a href="../api/io/micronaut/context/annotation/Executable.html">@Executable</a> annotation to any custom AOP advice you specify otherwise the method will not be available via the <a href="../api/io/micronaut/inject/BeanDefinition.html">BeanDefinition</a> interface (using for example the <a href="../api/io/micronaut/BeanDefinition/getExecutableMethods.html">getExecutableMethods</a> method).</p>
</div>
</div>
<div class="sect2">
<h3 id="_spot_bugs_instead_of_jsr_305_nullable_nonnull_annotations">Spot Bugs Instead of JSR-305 Nullable/NonNull Annotations</h3>
<div class="paragraph">
<p>The JSR-305 annotations library (<code>com.google.code.findbugs:jsr305</code>) is no longer a dependency (replaced by <code>spotbugs-annotations</code>). If you need this library you will need to add it manually.</p>
</div>
</div>
<div class="sect2">
<h3 id="_events_renamed">Events Renamed</h3>
<div class="paragraph">
<p>The following events were renamed to avoid confusion with other events of similar names:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Old Name</th>
<th class="tableblock halign-left valign-top">New Name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io.micronaut.discovery.event.ServiceStartedEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/discovery/event/ServiceReadyEvent.html">ServiceReadyEvent</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io.micronaut.discovery.event.ServiceShutdownEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/discovery/event/ServiceStoppedEvent.html">ServiceStoppedEvent</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_new_package_for_netty_specific_classes_of_http_client">New Package for Netty Specific Classes of HTTP Client</h3>
<div class="paragraph">
<p>The HTTP client implementation classes including <a href="../api/io/micronaut/http/client/netty/DefaultHttpClient.html">DefaultHttpClient</a> (considered internal in Micronaut 1.x) have been moved to a sub-package called <code>io.micronaut.http.client.netty</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_http_clients_no_longer_named_beans">HTTP Clients No Longer Named Beans</h3>
<div class="paragraph">
<p>HTTP clients declared with <code>micronaut.http.services</code> (see <a href="#serviceDiscoveryManual">Manual Service Discovery Configuration</a>) are no longer named beans in the context and cannot be injected with <code>javax.inject.Named</code>, for example given the configuration:</p>
</div>
<div class="listingblock">
<div class="title">Manually configuring services</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">micronaut:
    http:
        services:
            foo:
                urls:
                    - http://foo1
                    - http://foo2</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can no longer inject an HTTP client with <code>@Named("foo")</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@Named("foo")
RxHttpClient httpClient;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead you should always use <a href="../api/io/micronaut/http/client/annotation/Client.html">@Client</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@Client("foo")
RxHttpClient httpClient;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_source_retention_annotations_no_longer_retained_in_runtime_metadata">Source Retention Annotations No Longer Retained in Runtime Metadata</h3>
<div class="paragraph">
<p>In Micronaut 1.x annotations specified as source retention were still retained in the <a href="../api/io/micronaut/core/annotation/AnnotationMetadata.html">AnnotationMetadata</a> interface. As of Micronaut 2.x this is no longer the case with source retention annotations only available within the compiler APIs.</p>
</div>
<div class="paragraph">
<p>If you wish to retain a particular source level annotation when upgrading you can write an <a href="../api/io/micronaut/inject/annotation/AnnotationTransformer.html">AnnotationTransformer</a> that alters the <code>RetentionPolicy</code> of the annotation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_iterable_beans_no_longer_have_an_implicit_primary">Iterable Beans No Longer Have An Implicit Primary</h3>
<div class="paragraph">
<p>In Micronaut 1.x injecting a single instance of an iterable bean without qualifiers would inject the first bean. An iterable bean is typically anything annotated with <code>@EachProperty</code> or <code>@EachBean</code>. Those beans typically are referenced from configuration. The first bean in this context is the first item in configuration that matches what the annotation expects.</p>
</div>
<div class="paragraph">
<p>For example if you created a bean with <code>@EachProperty("cars")</code>, then specified the following in your config:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">cars:
    ford:
        cylinders: 8
    subaru:
        cylinders: 4</code></pre>
</div>
</div>
<div class="paragraph">
<p>Requesting a single instance of that bean would result in the "ford" instance being injected. Because that behavior is surprising and inconsistent with other types of beans, that is no longer the case and a <code>NonUniqueBeanException</code> will be thrown.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This change does not apply to an explicit primary defined in the annotation (<code>@EachProperty(value = "cars", primary = "ford")</code>), nor requesting the instance by a qualifier (<code>@Named("ford") CarConfig carConfig</code>).
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_no_longer_possible_to_return_null_to_disable_a_bean">No Longer Possible to Return Null to Disable a Bean</h3>
<div class="paragraph">
<p>It is no longer possible to return <code>null</code> from a <a href="../api/io/micronaut/context/annotation/Factory.html">@Factory</a> bean method to disable the bean. You should now throw <a href="../api/io/micronaut/context/exceptions/DisabledBeanException.html">DisabledBeanException</a> instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="_invalid_configuration_file_locations">Invalid Configuration File Locations</h3>
<div class="paragraph">
<p>Specifying a file with <code>micronaut.config.files</code>, either through the system property or environment variable, that does not exist or cannot be read will now result in the application failing to startup. In previous versions of Micronaut a warning would be logged and the file would be ignored.</p>
</div>
</div>
<div class="sect2">
<h3 id="_propertysourceloader_changes">PropertySourceLoader Changes</h3>
<div class="paragraph">
<p>Some default interface methods are no longer default and require implementation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_deprecation_removal">Deprecation Removal</h3>
<div class="paragraph">
<p>Most if not all deprecated classes and methods have been removed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_map_property_binding">Map Property Binding</h3>
<div class="paragraph">
<p>In Micronaut 1.x <code>java.util.Map</code> properties being bound from config were inconsistently bound as either a nested or flat. Now maps are bound as nested by default and the <a href="../api/io/micronaut/core/convert/format/MapFormat.html">@MapFormat</a> annotation&#8217;s default value for <code>transformation</code> has been changed to reflect that.</p>
</div>
<div class="paragraph">
<p>For example given the config:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">persons:
  joe:
    age: 30
  sally:
    age: 25</code></pre>
</div>
</div>
<div class="paragraph">
<p>A map property injected via <code>@Property(name ="persons")</code> may have been injected flat or nested depending on a couple factors.</p>
</div>
<div class="listingblock">
<div class="title">Flat</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{"joe.age": 30, "sally.age": 25}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Nested</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{"joe": {"age": 30}, "sally": {"age": 25}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To bind to a map with flat keys, add the <a href="../api/io/micronaut/core/convert/format/MapFormat.html">@MapFormat</a> annotation and set the <code>transformation</code> member.</p>
</div>
</div>
<div class="sect2">
<h3 id="_graalvm_bom_entry">GraalVM BOM Entry</h3>
<div class="paragraph">
<p>The no longer used group for Graal is no longer part of the bom. While upgrading if you depend on Graal you may see <code>Could not find com.oracle.substratevm:svm:.</code>. To resolve the issue, change the dependency group to <code>org.graalvm.nativeimage</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_code_retryable_code_and_code_circuitbreaker_code_exception_handling"><code>@Retryable</code> and <code>@CircuitBreaker</code> Exception Handling</h3>
<div class="paragraph">
<p><code>@Retryable</code> and <code>@CircuitBreaker</code> in previous versions of Micronaut resolved <code>includes</code> and <code>excludes</code> explicitly. Any exception thrown had to exactly match one of the exceptions specified. This has been changed to now also include subclasses of the exception types specified.</p>
</div>
</div>
<div class="sect2">
<h3 id="_messagesource_api_changes">MessageSource API Changes</h3>
<div class="paragraph">
<p>The semantics of the <code>getMessage</code> method have been changed to also interpolate the message with any provided variables. In previous versions of Micronaut, the raw message was returned from the bundle. To support reading the raw message, a new method <code>getRawMessage</code> has been added.</p>
</div>
<div class="paragraph">
<p>In addition, escaping of messages with single quotes is now implemented in accordance with the standard Java <a href="https://docs.oracle.com/javase/8/docs/api/java/text/MessageFormat.html">MessageFormat</a> class. Messages that contain a single quote will now need escaping in order for the quote to output as it did previously. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">my.message=We love Micronaut's documentation</code></pre>
</div>
</div>
<div class="paragraph">
<p>Would now be output as <code>We love Micronauts documentation</code>. To achieve the desired result, escape the single quote with another single quote.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">my.message=We love Micronaut''s documentation</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This change also applies to messages in custom constraint annotations, which interpolate the message via the message source api.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_environment_order_bugfix">Environment Order Bugfix</h3>
<div class="paragraph">
<p>Environments specified through the application context builder have priority over environments deduced or supplied through the MICRONAUT_ENVIRONMENTS environment variable, or the equivalent system property. A bug in the logic however did not change the order of a specified environment if it previously was found or deduced. This issue manifested itself with <code>@MicronautTest(environments = "test")</code>. The <code>test</code> environment is already deduced for tests, so it retained the order of other deduced environments, and was able to be overriden by <code>MICRONAUT_ENVIRONMENTS=dev</code>. In Micronaut 1.x configuration for <code>dev</code> would have overridden <code>test</code>. In Micronaut 2.x <code>test</code> will override <code>dev</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_introspections_and_inner_classes">Introspections and Inner Classes</h3>
<div class="paragraph">
<p>A bug in Micronaut 1.x caused bean introspections to be generated for inner classes of classes annotated with <code>@Introspected</code>. That also applies to classes where <code>@Introspection</code> is a meta annotation, like <code>@Entity</code>. This may have an impact for GraalVM users that rely on accesses to those classes without using reflection. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>@Entity
public class Pet {
    ...
    private PetType type = PetType.DOG;
    // getters &amp; setters

    public enum PetType {
        DOG,
        CAT
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Previously a bean introspection would have been generated for <code>PetType</code>. That is no longer the case. If the type should be introspected, simply add the annotation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_executable_methods">Executable Methods</h3>
<div class="paragraph">
<p>A bug in Micronaut 1.x caused bean definitions to be created for classes that only declared executable annotations on one or more methods. Classes with executable methods must now be explicitly declared as a bean with a scope annotation in order for a bean definition to be created.</p>
</div>
</div>
<div class="sect2">
<h3 id="_super_interfaces_no_longer_searched_for_fallbacks">Super interfaces No Longer Searched for Fallbacks</h3>
<div class="paragraph">
<p>If the <a href="../api/io/micronaut/retry/annotation/Fallback.html">@Fallback</a> annotation is used to specify a fallback for a <a href="../api/io/micronaut/http/client/annotation/Client.html">@Client</a> interface, the super interfaces of the client will no longer be traversed to lookup the fallback to invoke.</p>
</div>
<div class="paragraph">
<p>In this case it may be necessary to specify the <code>api</code> member of the <a href="../api/io/micronaut/retry/annotation/Recoverable.html">@Recoverable</a> annotation to ensure the fallback can be looked up. For example:</p>
</div>
<div class="listingblock">
<div class="title">Specifying the <code>api</code> to recover from</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Client("/Books")
@Recoverable(api = BookApi)
interface BookClient extends BookApi {
    @Override
    Book get(Long id);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_aws_functionclient_moved_to_aws_module">AWS FunctionClient Moved to AWS Module</h3>
<div class="paragraph">
<p>The AWS based function client has been made part of the <a href="https://github.com/micronaut-projects/micronaut-aws/">Micronaut AWS</a> project. If you need this functionality add the following dependency:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"io.micronaut.aws:micronaut-function-client-aws")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.aws&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-function-client-aws&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</p>
</div>
</div>
<div class="sect2">
<h3 id="_loglevel_enum_moved_to_io_micronaut_logging">LogLevel Enum Moved to io.micronaut.logging</h3>
<div class="paragraph">
<p><code>io.micronaut.management.endpoint.loggers.LogLevel</code> enum has moved to package <code>io.micronaut.logging</code></p>
</div>
</div>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../../guide/i18n.html">&lt;&lt; <strong>18</strong><span>Internationalization</span></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    
    
</div>

<script type="text/javascript" src="https://docs.micronaut.io/docsassets/js/docs.js"></script>

</body>
</html>
