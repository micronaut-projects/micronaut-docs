<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>14 Security 1.0.0.M2</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <div class="navTitle">
        
        Micronaut
    </div>
    <div class="navLinks">
        <ul>
            <li>
                <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                    <a href="../guide/index.html" class="button">Table of contents</a>

                    <div id="nav-summary-childs" style="display:none;">
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/introduction.html"><strong>1</strong><span>Introduction</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/quickStart.html"><strong>2</strong><span>Quick Start</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/ioc.html"><strong>3</strong><span>Inversion of Control</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/config.html"><strong>4</strong><span>Application Configuration</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/aop.html"><strong>5</strong><span>Aspect Oriented Programming</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/httpServer.html"><strong>6</strong><span>The HTTP Server</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/httpClient.html"><strong>7</strong><span>The HTTP Client</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/cloud.html"><strong>8</strong><span>Cloud Native Features</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/serverlessFunctions.html"><strong>9</strong><span>Serverless Functions</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/dataAccess.html"><strong>10</strong><span>Configurations for Data Access</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/otherConfigurations.html"><strong>11</strong><span>Other Configurations</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/languageSupport.html"><strong>12</strong><span>Language Support</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/management.html"><strong>13</strong><span>Management &amp; Monitoring</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/security.html"><strong>14</strong><span>Security</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/cli.html"><strong>15</strong><span>Micronaut CLI</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/faq.html"><strong>16</strong><span>Frequently Asked Questions (FAQ)</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/problems.html"><strong>17</strong><span>Common Problems</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/breaks.html"><strong>18</strong><span>Breaking Changes</span></a>
                        </div>
                        
                    </div>
                </div>
            </li>
            <li class="separator selected">
                <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
            </li>
        </ul>
    </div>


</div>

<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../guide/management.html">&lt;&lt; <strong>13</strong><span>Management &amp; Monitoring</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../guide/cli.html"><strong>15</strong><span>Micronaut CLI</span> >></a></div>
                


                <div class="project">
                    <h1>14 Security</h1>

                    <p><strong>Version:</strong> 1.0.0.M2</p>
                </div>

                
                <div id="table-of-content">
                    <h2>Table of Contents</h2>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#authenticationProviders"><strong>14.1</strong><span>Authentication Providers</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#securityRule"><strong>14.2</strong><span>Security Rules</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#ipPattern"><strong>14.2.1</strong><span>IP Pattern Rule</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#secured"><strong>14.2.2</strong><span>Secured Annotation</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#interceptUrlMap"><strong>14.2.3</strong><span>Intercept URL Map</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#builtInEndpointsAccess"><strong>14.2.4</strong><span>Built-In Endpoints Security</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#authenticationStrategies"><strong>14.3</strong><span>Authentication Strategies</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#basicAuth"><strong>14.3.1</strong><span>Basic Auth</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#session"><strong>14.3.2</strong><span>Session Authentication</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#jwt"><strong>14.3.3</strong><span>JSON Web Token</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#reader"><strong>14.3.3.1</strong><span>Reading JWT Token</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:30px"><a href="#bearerToken"><strong>14.3.3.1.1</strong><span>Bearer Token Reader</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:30px"><a href="#cookieToken"><strong>14.3.3.1.2</strong><span>Cookie Token Reader</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#jwtGenerator"><strong>14.3.3.2</strong><span>JWT Token Generation</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:30px"><a href="#jwtGeneratorSignature"><strong>14.3.3.2.1</strong><span>JWT Signature</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:30px"><a href="#jwtGeneratorEncryption"><strong>14.3.3.2.2</strong><span>Encrypted JWTs</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#jwtValidation"><strong>14.3.3.3</strong><span>JWT Token Validation</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#claimsGeneration"><strong>14.3.3.4</strong><span>Claims Generation</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#render"><strong>14.3.3.5</strong><span>Token Render</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#endpoints"><strong>14.4</strong><span>Built-In Security Controllers</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#login"><strong>14.4.1</strong><span>Login Controller</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#logout"><strong>14.4.2</strong><span>Logout Controller</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#refresh"><strong>14.4.3</strong><span>Refresh Controller</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#securityEvents"><strong>14.5</strong><span>Security Events</span></a>
                    </div>
                    
                </div>
                

                

<h1 id="security">14 Security</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To use the Micronaut&#8217;s security capabilities you must have the <code>security</code> dependency on your classpath. For example in <code>build.gradle</code>:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">compile <span class="string"><span class="delimiter">&quot;</span><span class="content">io.micronaut:security</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To enable security capabilities enable security:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">micronaut</span>:
    <span class="key">security</span>:
        <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once you enable security, Micronaut returns HTTP Status Unauthorized (401) for any endpoint invocation.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/secured_by_default.svg" alt="secured by default">
</div>
</div>


<h2 id="authenticationProviders">14.1 Authentication Providers</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/authenticationProviders.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To authenticate users you must provide implementations of <a href="../api/io/micronaut/security/authentication/AuthenticationProvider.html">AuthenticationProvider</a>.</p>
</div>
<div class="paragraph">
<p>The following code snippet illustrates a naive implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Singleton</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">AuthenticationProviderUserPassword</span> <span class="directive">implements</span> AuthenticationProvider {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> Publisher&lt;AuthenticationResponse&gt; authenticate(AuthenticationRequest authenticationRequest) {
        <span class="keyword">if</span> (authenticationRequest.getIdentity().equals(<span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>) &amp;&amp; authenticationRequest.getSecret().equals(<span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>)) {
            <span class="keyword">return</span> Flowable.just(<span class="keyword">new</span> UserDetails(<span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;()));
        }
        <span class="keyword">return</span> Flowable.just(<span class="keyword">new</span> AuthenticationFailed());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The built-in <a href="#login">Login Controller</a> uses every available authentication provider. Authentication strategies, such as basic auth, where the credentials are present in the request use the available authentication providers too.</p>
</div>
<div class="paragraph">
<p>Micronaut ships with <a href="../api/io/micronaut/security/authentication/providers/DelegatingAuthenticationProvider.html">DelegatingAuthenticationProvider</a> which can be typically used
in environments such as the one described in the next diagramm.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/delegating_authentication_provider.svg" alt="delegating authentication provider">
</div>
</div>
<div class="paragraph">
<p><code>DelegatingAuthenticationProvider</code> is not enabled unless you provide implementations for <a href="../api/io/micronaut/security/authentication/providers/UserFetcher.html">UserFetcher</a>,
<a href="../api/io/micronaut/security/authentication/providers/PasswordEncoder.html">PasswordEncoder</a> and  <a href="../api/io/micronaut/security/authentication/providers/AuthoritiesFetcher.html">AuthoritiesFetcher</a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Read the <a href="http://guides.micronaut.io/micronaut-database-authentication-provider-groovy/guide/index.html">LDAP and Database authentication providers</a> to learn more.
</td>
</tr>
</table>
</div>


<h2 id="securityRule">14.2 Security Rules</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/securityRule.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The decision to allow access to a particular endpoint to anonymous or authenticated users is determined by a collection of
Security Rules. Micronaut ships with several built-in security rules. If they don&#8217;t fulfil your needs,
you can implement your own <a href="../api/io/micronaut/security/rules/SecurityRule.html">SecurityRule</a>.</p>
</div>


<h2 id="ipPattern">14.2.1 IP Pattern Rule</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/securityRule/ipPattern.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>When you turn on security, traffic coming from any ip address is allowed by default.</p>
</div>
<div class="paragraph">
<p>You can however reject traffic not coming from a white list of IP Patterns as illustrated below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">micronaut</span>:
  <span class="key">security</span>:
    <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">ipPatterns</span>:
      - <span class="string"><span class="content">127.0.0.1</span></span>
      - <span class="string"><span class="content">192.168.1.*</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the previous code, the <a href="../apiio/micronaut/security/rules/IpPatternsRule.html">IpPatternsRule</a> rejects traffic not coming
either <code>127.0.0.1</code> or <code>192.168.1.*</code> range.</p>
</div>


<h2 id="secured">14.2.2 Secured Annotation</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/securityRule/secured.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>As illustrated below, you can use <a href="../api/io/micronaut/security/Secured.html">Secured</a> annotation to configure
access at <a href="../api/io/micronaut/http/annotation/Controller.html">Controller</a> or Controller&#8217;s Action level.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Controller</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/example</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Secured</span>(SecurityRule.IS_AUTHENTICATED) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ExampleController</span> {

    <span class="annotation">@Get</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/admin</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Secured</span>([<span class="string"><span class="delimiter">&quot;</span><span class="content">ROLE_ADMIN</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">ROLE_X</span><span class="delimiter">&quot;</span></span>]) <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="directive">public</span> <span class="predefined-type">String</span> withroles() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">You have ROLE_ADMIN or ROLE_X roles</span><span class="delimiter">&quot;</span></span>;
    }

    <span class="annotation">@Get</span>(<span class="string"><span class="delimiter">'</span><span class="content">/anonymous</span><span class="delimiter">'</span></span>)
    <span class="annotation">@Secured</span>(SecurityRule.IS_ANONYMOUS)  <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="directive">public</span> <span class="predefined-type">String</span> anonymous() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">You are anonymous</span><span class="delimiter">&quot;</span></span>;
    }

    <span class="annotation">@Get</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/authenticated</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="directive">public</span> <span class="predefined-type">String</span> authenticated(Authentication authentication) {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>authentication.name<span class="inline-delimiter">}</span></span><span class="content"> is authenticated</span><span class="delimiter">&quot;</span></span>;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Authenticated users are able to access <code>authenticated</code> Controller&#8217;s action.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Users granted role <code>ROLE_ADMIN</code> or <code>ROLE_X</code> roles can access <code>withroles</code> Controller&#8217;s action.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Anonymous users (authenticated and not authenticated users) can access <code>anonymous</code> Controller&#8217;s action.</td>
</tr>
</table>
</div>


<h2 id="interceptUrlMap">14.2.3 Intercept URL Map</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/securityRule/interceptUrlMap.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Moreover, you can configure endpoint authentication and authorization access with an Intercept URL Map:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">micronaut</span>:
  <span class="key">security</span>:
    <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">interceptUrlMap</span>:
      -
        <span class="key">pattern</span>: <span class="string"><span class="content">/images/*</span></span>
        <span class="key">httpMethod</span>: <span class="string"><span class="content">GET</span></span>
        <span class="key">access</span>:
          - <span class="string"><span class="content">isAnonymous() </span></span><i class="conum" data-value="1"></i><b>(1)</b>
      -
        <span class="key">pattern</span>: <span class="string"><span class="content">/books</span></span>
        <span class="key">access</span>:
          - <span class="string"><span class="content">isAuthenticated() </span></span><i class="conum" data-value="2"></i><b>(2)</b>
      -
        <span class="key">pattern</span>: <span class="string"><span class="content">/books/grails</span></span>
        <span class="key">httpMethod</span>: <span class="string"><span class="content">GET</span></span>
        <span class="key">access</span>:
          - <span class="string"><span class="content">ROLE_GRAILS </span></span><i class="conum" data-value="3"></i><b>(3)</b>
          - <span class="string"><span class="content">ROLE_GROOVY</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enable access to authenticated and not authenticated users</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Enable access for everyone authenticated</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Enable access for users who are granted any of the specified roles.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As you see in the previous code listing, any endpoint is identified by a combination of pattern
and an optional HTTP Method</p>
</div>


<h2 id="builtInEndpointsAccess">14.2.4 Built-In Endpoints Security</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/securityRule/builtInEndpointsAccess.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>When you turn on security, <a href="#providedEndpoints">Built-in endpoints</a> are secured depending on their sensitive value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">endpoints</span>:
  <span class="key">beans</span>:
    <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">sensitive</span>: <span class="string"><span class="content">true </span></span><i class="conum" data-value="1"></i><b>(1)</b>
  <span class="key">info</span>:
    <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">sensitive</span>: <span class="string"><span class="content">false  </span></span><i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>/beans</code> endpoint is secured</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>/info</code> endpoint is open for unauthenticated access.</td>
</tr>
</table>
</div>


<h2 id="authenticationStrategies">14.3 Authentication Strategies</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/authenticationStrategies.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>





<h2 id="basicAuth">14.3.1 Basic Auth</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/authenticationStrategies/basicAuth.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Out-of-the-box, Micronaut supports <a href="https://tools.ietf.org/html/rfc7617">RFC7617</a> which defines the "Basic" Hypertext Transfer Protocol (HTTP) authentication scheme, which transmits credentials as user-id/password pairs, encoded using Base64.</p>
</div>
<div class="paragraph">
<p>Once you enable Micronaut security, Basic Auth is enabled by default.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">micronaut</span>:
  <span class="key">security</span>:
    <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following sequence illustrates the authentication flow:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/basicauth.svg" alt="basicauth">
</div>
</div>
<div class="paragraph">
<p>Below is a sample of a cURL command using basic auth:</p>
</div>
<div class="listingblock">
<div class="title">cURL command using Basic Auth</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl &quot;http://localhost:8080/info&quot; \
     -u 'user:password'</code></pre>
</div>
</div>
<div class="paragraph">
<p>After credentials are read from the HTTP Header, they are feed into an <a href="../api/io/micronaut/security/authentication/Authenticator.html">Authenticator</a>
which attempts to validate them.</p>
</div>
<div class="paragraph">
<p>The following configuration properties are available to customize basic authentication behaviour:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.token.basicAuth.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/token/basicauth/BasicAuthTokenReader.html">BasicAuthTokenReader</a> is disabled by default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.token.basicAuth.headerName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Authorization</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Header name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.token.basicAuth.prefix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Basic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">e.g. <code>Basic dXNlcjp1c2Vy</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>See the javadoc for <a href="../api/io/micronaut/security/token/basicauth/BasicAuthTokenReaderConfigurationProperties.html">BasicAuthTokenReaderConfigurationProperties</a> for more information.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Read the <a href="http://guides.micronaut.io/micronaut-security-basicauth/guide/index.html">Basic Authentication Micronaut Guide</a> to learn more.
</td>
</tr>
</table>
</div>


<h2 id="session">14.3.2 Session Authentication</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/authenticationStrategies/session.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Micronaut supports Session based authentication.</p>
</div>
<div class="paragraph">
<p>To use the Micronaut&#8217;s session based authentication capabilities you must have the <code>security-session</code> dependency on your classpath. For example in <code>build.gradle</code>:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">compile <span class="string"><span class="delimiter">&quot;</span><span class="content">io.micronaut:security-session</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following sequence illustrates the authentication flow:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/sesssion_based_auth.svg" alt="sesssion based auth">
</div>
</div>
<div class="paragraph">
<p>The following configuration properties are available to customize session based authentication behaviour:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.session.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Session Authentication is disabled by default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.session.loginSuccessUrl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL where the user will be redirected ( 303 HTTP Status ) after login.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.session.loginFailureUrl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL where the user will be redirected ( 303 HTTP Status ) after an unsuccessful login attempt.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.session.logoutTargetUrl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL where the user will be redirected ( 303 HTTP Status ) after logout.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.session.unauthorizedTargetUrl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL where the user will be redirected ( 303 HTTP Status ) after an attempt to a access secured rule.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.session.forbiddenTargetUrl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL where the user will be redirected ( 303 HTTP Status ) after an attempt to a access secured rule but lacking enough privileges.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>See the <a href="../api/io/micronaut/security/session/SecuritySessionConfigurationProperties.html">SecuritySessionConfigurationProperties</a> javadoc for more information.</p>
</div>
<div class="sect1">
<h2 id="_example_of_session_based_authentication_configuration">Example of Session-Based Authentication configuration</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">micronaut</span>:
  <span class="key">security</span>:
    <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">endpoints</span>:
      <span class="key">login</span>:
        <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span>
      <span class="key">logout</span>:
        <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">session</span>:
      <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span>
      <span class="key">loginFailureTargetUrl</span>: <span class="string"><span class="content">/login/authFailed</span></span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Read the <a href="http://guides.micronaut.io/micronaut-security-session/guide/index.html">Session-Based Authentication Micronaut Guide</a> to learn more.
</td>
</tr>
</table>
</div>
</div>
</div>


<h2 id="jwt">14.3.3 JSON Web Token</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/authenticationStrategies/jwt.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Micronaut ships with security capabilities based on <a href="https://jwt.io/">Json Web Token (JWT)</a>.
JWT is an <a href="https://tools.ietf.org/html/rfc7519">IETF standard</a> which defines a secure way to encapsulate arbitrary data that can be sent over unsecure URLâ€™s.</p>
</div>
<div class="paragraph">
<p>To use the Micronaut&#8217;s JWT based authentication capabilities you must have the <code>security-jwt</code> dependency on your classpath. For example in <code>build.gradle</code>:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">compile <span class="string"><span class="delimiter">&quot;</span><span class="content">io.micronaut:security-jwt</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following configuration properties are available to customize JWT based authentication behaviour:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.token.jwt.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">You can enable JWT capabilities by enabling this property.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.token.rolesName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>roles</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default roles claim name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.token.defaultExpiration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3600</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access token expiration time in seconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.token.refreshTokenExpiration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>null</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Refresh token expiration time in milliseconds. By default, they don&#8217;t expire.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>See the javadoc for <a href="../api/io/micronaut/security/token/jwt/config/JwtConfigurationProperties.html">JwtConfigurationProperties</a> and <a href="../api/io/micronaut/security/token/config/TokenConfigurationProperties.html">TokenConfigurationProperties</a> for more information.</p>
</div>
<div class="sect1">
<h2 id="_what_does_a_jwt_look_like">What does a JWT look like?</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="../img/jwt.png" alt="jwt">
</div>
</div>
<div class="sect2">
<h3 id="_header">Header</h3>
<div class="paragraph">
<p>A base64-encoded JSON like:</p>
</div>
<div class="listingblock">
<div class="title">JWT header</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">alg</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">HS256</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">typ</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">JWT</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_claims">Claims</h3>
<div class="paragraph">
<p>A base64-encoded JSON like:</p>
</div>
<div class="listingblock">
<div class="title">JWT claims</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">exp</span><span class="delimiter">&quot;</span></span>: <span class="integer">1422990129</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">sub</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">jimi</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">roles</span><span class="delimiter">&quot;</span></span>: [
        <span class="string"><span class="delimiter">&quot;</span><span class="content">ROLE_ADMIN</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">ROLE_USER</span><span class="delimiter">&quot;</span></span>
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">iat</span><span class="delimiter">&quot;</span></span>: <span class="integer">1422986529</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_signature">Signature</h3>
<div class="paragraph">
<p>Depends on the algorithm specified on the header, it can be a digital signature of the base64-encoded header and claims, or an encryption of them.</p>
</div>
</div>
</div>
</div>


<h2 id="reader">14.3.3.1 Reading JWT Token</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/authenticationStrategies/jwt/reader.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>





<h2 id="bearerToken">14.3.3.1.1 Bearer Token Reader</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/authenticationStrategies/jwt/reader/bearerToken.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Micronaut supports <a href="https://tools.ietf.org/html/rfc6750">RFC 6750 Bearer Token</a> specification out-of-the-box.</p>
</div>
<div class="paragraph">
<p>It is enabled by default but requires JWT Authentication to be enabled.</p>
</div>
<div class="paragraph">
<p>The following sequence illustrates the authentication flow:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/jwt-bearer-token.svg" alt="jwt bearer token">
</div>
</div>
<div class="paragraph">
<p>The following configuration properties are available to customize Bearer Token read:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.token.jwt.bearer.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/token/jwt/bearer/BearerTokenReader.html">BearerTokenReader</a> is enabled by default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.token.jwt.bearer.headerName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Authorization</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Header name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.token.jwt.bearer.prefix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bearer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">e.g. <code>Bearer XXXXXXXXXXX</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>See the javadoc for <a href="../api/io/micronaut/security/token/jwt/bearer/BearerTokenConfigurationProperties.html">BearerTokenConfigurationProperties</a> for more information.</p>
</div>
<div class="sect1">
<h2 id="_sending_tokens_in_the_request">Sending tokens in the request</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following code snippet illustrates how to send a JWT token in the <code>Authorization</code> request header:</p>
</div>
<div class="listingblock">
<div class="title">Accessing a protected resource using Authorization request header</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">GET /protectedResource HTTP/1.1
Host: micronaut.example
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJleHAiOjE0MjI5OTU5MjIsInN1YiI6ImppbWkiLCJyb2xlcyI6WyJST0xFX0FETUlOIiwiUk9MRV9VU0VSIl0sImlhdCI6MTQyMjk5MjMyMn0.rA7A2Gwt14LaYMpxNRtrCdO24RGrfHtZXY9fIjV8x8o</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Read the <a href="http://guides.micronaut.io/micronaut-security-jwt/guide/index.html">Micronaut JWT Authentication</a> to learn more.
</td>
</tr>
</table>
</div>
</div>
</div>


<h2 id="cookieToken">14.3.3.1.2 Cookie Token Reader</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/authenticationStrategies/jwt/reader/cookieToken.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You can send/read a JWT token from a Cookie too.</p>
</div>
<div class="paragraph">
<p>The following sequence illustrates the authentication flow:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/jwt-cookie.svg" alt="jwt cookie">
</div>
</div>
<div class="paragraph">
<p>Reading tokens from Cookies is disabled by default. Note that using JWT tokens from cookies requires JWT Authentication to be enabled.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.token.jwt.cookie.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled by default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.token.jwt.cookie.cookieName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JWT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cookie name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.token.jwt.cookie.logoutTargetUrl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String to be parsed into a URI which represents where the user is redirected to after logout.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.token.jwt.cookie.loginSuccessTargetUrl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String to be parsed into a URI which represents where the user is redirected to after a successful login.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.token.jwt.cookie.loginFailureTargetUrl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String to be parsed into a URI which represents where the user is redirected to after a failed login.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>See the javadoc for <a href="../api/io/micronaut/security/token/jwt/cookie/JwtCookieConfigurationProperties.html">JwtCookieConfigurationProperties</a> for more information.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Read the <a href="http://guides.micronaut.io/micronaut-security-jwt-cookie/guide/index.html">Micronaut JWT Authentication with Cookies</a> to learn more.
</td>
</tr>
</table>
</div>


<h2 id="jwtGenerator">14.3.3.2 JWT Token Generation</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/authenticationStrategies/jwt/jwtGenerator.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Micronaut relies on <a href="https://connect2id.com/products/nimbus-jose-jwt">Nimbus JOSE + JWT</a> library to provide JWT token signature and encryption.</p>
</div>


<h2 id="jwtGeneratorSignature">14.3.3.2.1 JWT Signature</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/authenticationStrategies/jwt/jwtGenerator/jwtGeneratorSignature.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Micronaut security capabilities use signed JWTâ€™s as specified by the
<a href="https://tools.ietf.org/html/rfc7515">JSON Web Signature</a> specification.</p>
</div>
<div class="paragraph">
<p>To enable a JWT signature in token generation, you need to have in your app a bean of type <a href="../api/io/micronaut/security/token/jwt/signature/rsa/RSASignatureConfiguration.html">RSASignatureConfiguration</a>,
<a href="../api/io/micronaut/security/token/jwt/signature/ec/ECSignatureConfiguration.html">ECSignatureConfiguration</a>,
<a href="../api/io/micronaut/security/token/jwt/signature/secret/SecretSignatureConfiguration.html">SecretSignatureConfiguration</a> qualified with name <code>generator</code>.</p>
</div>
<div class="paragraph">
<p>You can setup a <code>SecretSignatureConfiguration</code> named <code>generator</code> easily via configuration properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">micronaut</span>:
  <span class="key">security</span>:
    <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">token</span>:
      <span class="key">jwt</span>:
        <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span>
        <span class="key">signatures</span>:
          <span class="key">secret</span>:
            <span class="key">generator</span>:
              <span class="key">secret</span>: <span class="string"><span class="content">pleaseChangeThisSecretForANewOne </span></span><i class="conum" data-value="1"></i><b>(1)</b>
              <span class="key">jwsAlgorithm</span>: <span class="string"><span class="content">HS256 </span></span><i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><strong>Change this for your own secret and keep it safe</strong>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Json Web Token Signature name. In this example, HMAC using SHA-256 hash algorithm.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can supply the secret with Base64 encoding.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">micronaut</span>:
  <span class="key">security</span>:
    <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">token</span>:
      <span class="key">jwt</span>:
        <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span>
        <span class="key">signatures</span>:
          <span class="key">secret</span>:
            <span class="key">generator</span>:
              <span class="key">secret</span>: <span class="string"><span class="content">'cGxlYXNlQ2hhbmdlVGhpc1NlY3JldEZvckFOZXdPbmU=' </span></span><i class="conum" data-value="1"></i><b>(1)</b>
              <span class="key">base64</span>: <span class="string"><span class="content">true </span></span><i class="conum" data-value="2"></i><b>(2)</b>
              <span class="key">jwsAlgorithm</span>: <span class="string"><span class="content">HS256</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Secret Base64 encoded</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Signal that the secret is Base64 encoded</td>
</tr>
</table>
</div>


<h2 id="jwtGeneratorEncryption">14.3.3.2.2 Encrypted JWTs</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/authenticationStrategies/jwt/jwtGenerator/jwtGeneratorEncryption.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Signed claims prevents an attacker to tamper its contents to introduce malicious data or try a privilege escalation by adding more roles. However, the claims can be decoded just by using Base 64.</p>
</div>
<div class="paragraph">
<p>If the claims contains sensitive information, you can use a JSON Web Encryption algorithm to prevent them to be decoded.</p>
</div>
<div class="paragraph">
<p>To enable a JWT encryption in token generation, you need to have in your app a bean of type  <a href="../api/io/micronaut/security/token/jwt/encryption/rsa/RSAEncryptionConfiguration.html">RSAEncryptionConfiguration</a>,
<a href="../api/io/micronaut/security/token/jwt/encryption/ec/ECEncryptionConfiguration.html">ECEncryptionConfiguration</a>,
<a href="../api/io/micronaut/security/token/jwt/encryption/secret/SecretEncryptionConfiguration.html">SecretEncryptionConfiguration</a> qualified with name <code>generator</code>.</p>
</div>
<div class="sect1">
<h2 id="_example_of_jwt_signed_with_secret_and_encrypted_with_rsa">Example of JWT Signed with Secret and Encrypted with RSA</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Setup a <a href="../api/io/micronaut/security/token/jwt/signature/secret/SecretSignatureConfiguration.html">SecretSignatureConfiguration</a> through configuration properties</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="key">micronaut</span>:
  <span class="key">security</span>:
    <span class="key">enabled</span>: <span class="predefined-constant">true</span>
    <span class="key">token</span>:
      <span class="key">jwt</span>:
        <span class="key">enabled</span>: <span class="predefined-constant">true</span>
        <span class="key">signatures</span>:
          <span class="key">secret</span>:
            <span class="key">generator</span>:
              <span class="key">secret</span>: pleaseChangeThisSecretForANewOne <i class="conum" data-value="1"></i><b>(1)</b>
              <span class="key">jwsAlgorithm</span>: HS256 <i class="conum" data-value="2"></i><b>(2)</b>
<span class="key">pem</span>:
  <span class="key">path</span>: <span class="regexp"><span class="delimiter">/</span><span class="content">home</span><span class="delimiter">/</span></span>user/rsa-<span class="integer">2048</span>bit-key-pair.pem <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Name the Signature configuration <code>generator</code> to make it participate in JWT token generation.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Location of PEM file</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Generate a 2048-bit RSA private + public key pair:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">openssl genrsa -out rsa-2048bit-key-pair.pem 2048</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Named</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">generator</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@Singleton</span>
<span class="type">class</span> <span class="class">RSAOAEPEncryptionConfiguration</span> <span class="directive">implements</span> RSAEncryptionConfiguration {

    <span class="directive">private</span> <span class="predefined-type">RSAPrivateKey</span> rsaPrivateKey
    <span class="directive">private</span> <span class="predefined-type">RSAPublicKey</span> rsaPublicKey
    JWEAlgorithm jweAlgorithm = JWEAlgorithm.RSA_OAEP_256
    EncryptionMethod encryptionMethod = EncryptionMethod.A128GCM

    RSAOAEPEncryptionConfiguration(<span class="annotation">@Value</span>(<span class="string"><span class="delimiter">'</span><span class="content">${pem.path}</span><span class="delimiter">'</span></span>) <span class="predefined-type">String</span> pemPath) {
        Optional&lt;<span class="predefined-type">KeyPair</span>&gt; keyPair = KeyPairProvider.keyPair(pemPath)
        <span class="keyword">if</span> (keyPair.isPresent()) {
            <span class="local-variable">this</span>.rsaPublicKey = (<span class="predefined-type">RSAPublicKey</span>) keyPair.get().getPublic()
            <span class="local-variable">this</span>.rsaPrivateKey = (<span class="predefined-type">RSAPrivateKey</span>) keyPair.get().getPrivate()
        }
    }

    <span class="annotation">@Override</span>
    <span class="predefined-type">RSAPublicKey</span> getPublicKey() {
        <span class="keyword">return</span> rsaPublicKey
    }

    <span class="annotation">@Override</span>
    <span class="predefined-type">RSAPrivateKey</span> getPrivateKey() {
        <span class="keyword">return</span> rsaPrivateKey
    }

    <span class="annotation">@Override</span>
    JWEAlgorithm getJweAlgorithm() {
        <span class="keyword">return</span> jweAlgorithm
    }

    <span class="annotation">@Override</span>
    EncryptionMethod getEncryptionMethod() {
        <span class="keyword">return</span> encryptionMethod
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Name Bean <code>generator</code> to designate this bean as participant in the JWT Token Generation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To parse the PEM key, use a collaborator as described in <a href="https://connect2id.com/products/nimbus-jose-jwt/openssl-key-generation">OpenSSL key generation</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Slf4j</span>
<span class="type">class</span> <span class="class">KeyPairProvider</span> {
    <span class="comment">/**
     *
     * @param pemPath Full path to PEM file.
     * @return returns KeyPair if successfully for PEM files.
     */</span>
    <span class="directive">static</span> Optional&lt;<span class="predefined-type">KeyPair</span>&gt; keyPair(<span class="predefined-type">String</span> pemPath) {
        <span class="comment">// Load BouncyCastle as JCA provider</span>
        <span class="predefined-type">Security</span>.addProvider(<span class="keyword">new</span> BouncyCastleProvider())

        <span class="comment">// Parse the EC key pair</span>
        PEMParser pemParser
        <span class="keyword">try</span> {
            pemParser = <span class="keyword">new</span> PEMParser(<span class="keyword">new</span> <span class="predefined-type">InputStreamReader</span>(<span class="keyword">new</span> <span class="predefined-type">FileInputStream</span>(pemPath)))
            PEMKeyPair pemKeyPair = (PEMKeyPair) pemParser.readObject()

            <span class="comment">// Convert to Java (JCA) format</span>
            JcaPEMKeyConverter converter = <span class="keyword">new</span> JcaPEMKeyConverter()
            <span class="predefined-type">KeyPair</span> keyPair = converter.getKeyPair(pemKeyPair)
            pemParser.close()

            <span class="keyword">return</span> Optional.of(keyPair)

        } <span class="keyword">catch</span> (<span class="exception">FileNotFoundException</span> e) {
            log.warn(<span class="string"><span class="delimiter">&quot;</span><span class="content">file not found: {}</span><span class="delimiter">&quot;</span></span>, pemPath)

        } <span class="keyword">catch</span> (PEMException e) {
            log.warn(<span class="string"><span class="delimiter">&quot;</span><span class="content">PEMException {}</span><span class="delimiter">&quot;</span></span>, e.getMessage())

        } <span class="keyword">catch</span> (<span class="exception">IOException</span> e) {
            log.warn(<span class="string"><span class="delimiter">&quot;</span><span class="content">IOException {}</span><span class="delimiter">&quot;</span></span>, e.getMessage())
        }
        <span class="keyword">return</span> Optional.empty()
    }
}</code></pre>
</div>
</div>
</div>
</div>


<h2 id="jwtValidation">14.3.3.3 JWT Token Validation</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/authenticationStrategies/jwt/jwtValidation.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Micronaut&#8217;s JWT validation support multiple Signature and Encryption configurations.</p>
</div>
<div class="paragraph">
<p>Any beans of type <a href="../api/io/micronaut/security/token/jwt/signature/rsa/RSASignatureConfiguration.html">RSASignatureConfiguration</a>,
<a href="../api/io/micronaut/security/token/jwt/signature/ec/ECSignatureConfiguration.html">ECSignatureConfiguration</a>,
<a href="../api/io/micronaut/security/token/jwt/signature/secret/SecretSignatureConfiguration.html">SecretSignatureConfiguration</a>
participate as signature configurations in the JWT validation.</p>
</div>
<div class="paragraph">
<p>Any beans of type <a href="../api/io/micronaut/security/token/jwt/encryption/rsa/RSAEncryptionConfiguration.html">RSAEncryptionConfiguration</a>,
<a href="../api/io/micronaut/security/token/jwt/encryption/ec/ECEncryptionConfiguration.html">ECEncryptionConfiguration</a>,
<a href="../api/io/micronaut/security/token/jwt/encryption/secret/SecretEncryptionConfiguration.html">SecretEncryptionConfiguration</a> participate as encryption configurations in the JWT validation.</p>
</div>


<h2 id="claimsGeneration">14.3.3.4 Claims Generation</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/authenticationStrategies/jwt/claimsGeneration.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>If the built-in
<a href="../api/io/micronaut/security/token/jwt/generator/claims/JWTClaimsSetGenerator.html">JWTClaimsSetGenerator</a>, does not
fulfil your needs you can provide your own <a href="#replaces">replacement</a> of <a href="../api/io/micronaut/security/token/jwt/generator/claims/ClaimsGenerator.html">ClaimsGenerator</a>.</p>
</div>


<h2 id="render">14.3.3.5 Token Render</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/authenticationStrategies/jwt/render.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>When you use JWT authentication and the built-in <a href="#login">LoginController</a>,
the JWT tokens are returned to the client as part of an OAuth 2.0 <a href="https://tools.ietf.org/html/RFC6749">RFC6749</a> access token response.</p>
</div>
<div class="paragraph">
<p>An example of such a response is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><span class="error">H</span><span class="error">T</span><span class="error">T</span><span class="error">P</span><span class="error">/</span><span class="float">1.1</span> <span class="integer">200</span> <span class="error">O</span><span class="error">K</span>
<span class="error">C</span><span class="error">o</span><span class="error">n</span><span class="error">t</span><span class="error">e</span><span class="error">n</span><span class="error">t</span><span class="error">-</span><span class="error">T</span><span class="error">y</span><span class="error">p</span><span class="error">e</span>: <span class="error">a</span><span class="error">p</span><span class="error">p</span><span class="error">l</span><span class="error">i</span><span class="error">c</span><span class="error">a</span><span class="error">t</span><span class="error">i</span><span class="error">o</span><span class="error">n</span><span class="error">/</span><span class="error">j</span><span class="error">s</span><span class="error">o</span><span class="error">n</span><span class="error">;</span><span class="error">c</span><span class="error">h</span><span class="error">a</span><span class="error">r</span><span class="error">s</span><span class="error">e</span><span class="error">t</span><span class="error">=</span><span class="error">U</span><span class="error">T</span><span class="error">F</span><span class="integer">-8</span>
<span class="error">C</span><span class="error">a</span><span class="error">c</span><span class="error">h</span><span class="error">e</span><span class="error">-</span><span class="error">C</span><span class="error">o</span><span class="error">n</span><span class="error">t</span><span class="error">r</span><span class="error">o</span><span class="error">l</span>: <span class="error">n</span><span class="error">o</span><span class="error">-</span><span class="error">s</span><span class="error">t</span><span class="error">o</span><span class="error">r</span><span class="error">e</span>
<span class="error">P</span><span class="error">r</span><span class="error">a</span><span class="error">g</span><span class="error">m</span><span class="error">a</span>: <span class="error">n</span><span class="error">o</span><span class="error">-</span><span class="error">c</span><span class="error">a</span><span class="error">c</span><span class="error">h</span><span class="error">e</span>
{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">access_token</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">eyJhbGciOiJIUzI1NiJ9...</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">token_type</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Bearer</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">expires_in</span><span class="delimiter">&quot;</span></span>:<span class="integer">3600</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">refresh_token</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">tGzv3JOkF0XG5Qx2TlKWIA...</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">euler</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">roles</span><span class="delimiter">&quot;</span></span>: [
        <span class="string"><span class="delimiter">&quot;</span><span class="content">ROLE_USER</span><span class="delimiter">&quot;</span></span>
    ],
}</code></pre>
</div>
</div>


<h2 id="endpoints">14.4 Built-In Security Controllers</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/endpoints.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>





<h2 id="login">14.4.1 Login Controller</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/endpoints/login.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You can enable <code>LoginController</code> with configuration property:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Possible Values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.endpoints.login.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> or <code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.endpoints.login.path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/login</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default path for <code>POST</code> requests.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The response of the Login Endpoint is handled by a bean instance of <a href="../api/io/micronaut/security/handlers/LoginHandler.html">LoginHandler</a>.</p>
</div>
<div class="sect1">
<h2 id="_login_endpoint_invocation_example">Login Endpoint invocation example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">Login Endpoint invocation example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl -X &quot;POST&quot; &quot;http://localhost:8080/login&quot; \
     -H 'Content-Type: application/json; charset=utf-8' \
     -d $'{
  &quot;username&quot;: &quot;euler&quot;,
  &quot;password&quot;: &quot;password&quot;
}'</code></pre>
</div>
</div>
</div>
</div>


<h2 id="logout">14.4.2 Logout Controller</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/endpoints/logout.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You can enable <code>LogoutController</code> with configuration property:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Possible Values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.endpoints.logout.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> or <code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.endpoints.logout.path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/logout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default path for <code>POST</code> requests.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Each bean of type <a href="../api/io/micronaut/security/handlers/LogoutHandler.html">LogoutHandler</a> gets invoked.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are using JWT authentication, you may not need to invoke the <code>/logout</code> endpoint. Since logging out normally means simply deleting access, refresh JWT tokens at the client side.
</td>
</tr>
</table>
</div>
<div class="sect1">
<h2 id="_logout_endpoint_invocation_example">Logout Endpoint invocation example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">Login Endpoint invocation example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl -X &quot;POST&quot; &quot;http://localhost:8080/logout&quot;</code></pre>
</div>
</div>
</div>
</div>


<h2 id="refresh">14.4.3 Refresh Controller</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/endpoints/refresh.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This controller can only be enabled if you are using JWT authentication.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, issued access tokens expire after a period of time, and they are paired with refresh tokens. To
ease the refresh, you can enable <a href="../api/io/micronaut/security/token/jwt/endpoints/OauthController.html">OauthController</a>, with configuration property:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Possible Values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.endpoints.oauth.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> or <code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.endpoints.oauth.path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/oauth/access_token</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default path for <code>POST</code> requests.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The controller exposes an endpoint as defined by <a href="https://tools.ietf.org/html/rfc6749#section-6">section 6 of the OAuth 2.0 spec</a> - Refreshing an Access Token.</p>
</div>
<div class="paragraph">
<p>By default, issued Refresh tokens never expire, and can be used to obtain a new access token by sending a POST request to the <code>/oauth/access_token</code> endpoint:</p>
</div>
<div class="listingblock">
<div class="title">Sample HTTP request to obtain an access token</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">POST /myApp/oauth/access_token HTTP/1.1
Host: micronaut.example
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&amp;refresh_token=eyJhbGciOiJSU0EtT0FFUCIsImVuYyI6IkEyNTZHQ00ifQ....</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, is a form request with 2 parameters:</p>
</div>
<div class="paragraph">
<p><code>grant_type</code>: must be <code>refresh_token</code> always.</p>
</div>
<div class="paragraph">
<p><code>refresh_token</code>: the refresh token obtained previously.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
By default refresh tokens never expire, they must be securely stored in your client application.
See <a href="https://tools.ietf.org/html/rfc6749#section-10.4">section 10.4 of the OAuth 2.0 spec</a> for more information.
</td>
</tr>
</table>
</div>


<h2 id="securityEvents">14.5 Security Events</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-core/edit/master/src/main/docs/guide/security/securityEvents.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Micronaut security classes generate several <a href="../api/io/micronaut/context/event/ApplicationEvent.html">ApplicationEvent</a>s which you can subscribe to.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Event Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/event/LoginFailedEvent.html">LoginFailedEvent</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Triggered when an unsuccessful login takes place.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/event/LoginSuccessfulEvent.html">LoginSuccessfulEvent</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Triggered when a successful login takes place.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/event/LogoutEvent.html">LogoutEvent</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Triggered when the user logs out.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/event/TokenValidatedEvent.html">TokenValidatedEvent</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Triggered when a token is validated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/token/jwt/event/AccessTokenGeneratedEvent.html">AccessTokenGeneratedEvent</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Triggered when a JWT access token is generated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/token/jwt/event/RefreshTokenGeneratedEvent.html">RefreshTokenGeneratedEvent</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Triggered when a JWT refresh token is generated.</p></td>
</tr>
</tbody>
</table>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../guide/management.html">&lt;&lt; <strong>13</strong><span>Management &amp; Monitoring</span></a></div>
                
                    <div class="toc-item next-right"><a href="../guide/cli.html"><strong>15</strong><span>Micronaut CLI</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
